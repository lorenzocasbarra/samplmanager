#
# This file will be automatically parsed.  It must contain the following eight elements:
# predictions, participant name, participant organization, name of method, software listing, method, method category, and ranked.
# These elements must be provided in the order shown.
# The file name must begin with the letters "CD" and then be followed by an underscore or dash.
#
# FILE FORMAT: All comment lines in this file (which begin with #) will be ignored.
# Please use only UTF-8 characters in the non-comment fields. If your information (e.g. your name, etc.)
# contains a non-UTF-8 character, you may note it in comments near that entry.
#
#
# PREDICTIONS
# Please explicitly describe how you handle ions and pKa effects.
#
# The data in each prediction line should be structured as follows, with all (up to six) numbers in kcal/mol.
# host-guest ID (note that the host varies!), Free energy, free energy SEM, free energy model uncertainty,
# enthalpy, enthalpy SEM, enthalpy model uncertainty
# The free energy, free energy SEM, and free energy model uncertainty are REQUIRED.
# The corresponding quantities for binding enthalpy are optional.
#
# Note that the "model uncertainty" should be your estimate of ACCURACY of this particular approach
# for the compound considered.
#
# For the CD challenge, beta CD (bCD) is optional and will not be judged, as
# literature values are available.
# Likewise, for the GDCC challenge, OA binding values for guests 1-6 (but not 7-8)
# are optional as literature values are available.
#
# The list of predictions must begin with the "Prediction:" keyword, as illustrated here.
Predictions:
bCD-g1,      -5.12,  0.03, 0.8,,,
bCD-g2,      -5.45,  0.13, 0.8,,,
MGLab_8-g1,  -1.75,  0.36, 0.8,,,
MGLab_8-g2,  -3.48,  0.20, 0.8,,,
MGLab_9-g1,  -5.24,  0.03, 0.8,,,
MGLab_9-g2,  -5.81,  0.17, 0.8,,,
MGLab_19-g1, -5.10,  0.03, 0.8,,,
MGLab_19-g2, -4.58,  0.03, 0.8,,,
MGLab_23-g1, -5.43,  0.03, 0.8,,,
MGLab_23-g2, -5.44,  0.42, 0.8,,,
MGLab_24-g1, -5.48,  0.09, 0.8,,,
MGLab_24-g2, -5.25,  0.07, 0.8,,,
MGLab_34-g1, -5.17,  0.04, 0.8,,,
MGLab_34-g2, -5.72,  0.07, 0.8,,,
MGLab_35-g1, -5.12,  0.04, 0.8,,,
MGLab_35-g2, -5.55,  0.04, 0.8,,,
MGLab_36-g1, -6.18,  0.10, 0.8,,,
MGLab_36-g2, -5.18,  0.07, 0.8,,,
#
#
# Please list your name, using only UTF-8 characters as described above. The "Participant name:" entry is required.
Participant name:
Yuriy Khalak, Vytautas Gapsys, Bert de Groot
#
#
# Please list your organization/affiliation, using only UTF-8 characters as described above.
Participant organization:
Max Planck Institute for Biophysical Chemistry, GÃ¶ttingen, Germany
#
#
# Please provide a brief (40 character limit) informal yet informative name of the method used.
# Following is sample text; please edit to your taste.
# The "Name:" keyword is required, as shown here.
# 40 character limit.
Name:
Noneq/Alchemy/CGENFF
#
# All major software packages used and their versions
# Following is sample text; please edit to your taste.
# The "Software:" keyword is required.
Software:
Gromacs 2019.4
pmx 1.1
https://cgenff.umaryland.edu webserver
#
# Methodology and computational details.
# Level of detail should be at least that used in a publication.
# Please include the values of key parameters, with units, and explain how any
# statistical uncertainties were estimated.
# Use as many lines of text as you need.
# Please explicitly describe how you handle ions (e.g. counterions) and pKa effects
# Following is sample text; please edit to your taste.
# All text following the "Method:" keyword will be regarded as part of your free text methods description.
Method:

Hosts and guest were parameterized with the CGenFF 4.1
using https://cgenff.umaryland.edu webserver. Ionization states
from the latest version of this challenge's GitHub repository were used.
Initial structures were generated by positioning the guest so its
center of geometry equals to that of the host
while its longest axis is perpendicular to the plane of the host.
This resulted in two orientations, corresponding to
two possible binding poses, for each
host-guest system: one where the polar group of the guest
is in the direction of the primary face
(the face with only one hydroxyl group per cyclodextrin residue)
of the host and one with the polar group oriented out of the
secondary face (two hydroxyls per residue).
Separate sets of simulations were carried out for each of these
binding poses for each host-guest system.
For systems where both binding poses were deemed stable,
absolute free energies are reported as a Boltzmann weighted average
of the poses.

Simulation boxes were set up for a double-system/single-box setup by
adding a second molecule of the guest at a distance of 3 nm from the host
and adding 1.5 nm of padding between the resulting solute and the box edges.
This second guest was held in a coupling state opposite to that of the
first guest (the one in contact with the host).
Harmonic position restraints with a force constant of 1000 kJ/(mol*nm^2)
were applied to one atom of the host and one atom
of the second guest to remove overall translation.
The solute was then surrounded with TIP3P water.
Sodium and chloride counterions
were introduced at a 25mM concentration.
No ions were placed within 3 A of the solute.

All simulations were performed with Gromacs 2019.4 at
a temperature of 300.15 K using the stochastic dynamics integrator
with an inverse friction constant of 2 ps.
Cutoffs of 1.1 nm with a switching function starting at 1.0 nm were employed.
For each combination of host, guest, binding pose,
and end state (first guest coupled and second decoupled and vice versa)
six equilibrium trajectories were generated as described below.
To retain the decoupled first guest in the relevant binding pose,
harmonic relative restraints (force constants of 1000 kcal/(mol*nm^2)
for distance and 10 kcal/(mol*rad^2) for angles and dihedrals)
were applied as described by Boresch et al. (10.1021/jp0217839).
Additional position restraints with a force constant
of 1000 kJ/(mol*nm^2) were introduced for all solute atoms
for equilibration. Following initial energy minimization,
a 300 ps NVT simulation was carried out.
The additional position restraints were then disabled and
a 20 ns production simulation was carried out in
the NPT ensemble with the Parrinello-Rahman
barrostat (10.1103/PhysRevLett.45.1196, 10.1063/1.328693)
using a 5 ps time constant. The first 5 ns of this
simulation were discarded as final equilibration.

For each combination of host, guest, binding pose,
and end state three repeats where the
first guest did not unbind or flip to the opposite
binding pose were chosen for thermodynamic integration
to the opposite end state. Binding poses where
this was not possible were discarded as too weakly binding
to significantly contribute to the overall absolute free energy of binding.
For each such repeat 151 initial frames separated by 50 ps
were obtained from the equilibrium trajectories and
500 ps NPT simulations were run from each one driving
the system to the opposite end state by linearly changing lambda.

Based on the Crooks Fluctuation Theorem (10.1103/PhysRevE.60.2721),
the work done by these simulations was analyzed with the
maximum likelihood estimator (10.1103/PhysRevLett.91.140601)
to obtain the free energy of transition between
the end states and an analytical correction (10.1021/jp0217839)
due to the effect of the relative restraints was added to obtain the
free energy of binding for each repeat.
The value for each binding pose
was taken from the average of the corresponding repeats.
In cases where only one binding pose was deemed
relevant, these are the values reported as the results.
Otherwise, the reported free energy is obtained by
Boltzmann weighted averaging over the two poses with
the standard deviations being propagated through the averaging
to compute the standard errors of the mean.




#
#
# METHOD CATEGORY SECTION
#
# State which method category your prediction method is better described as:
# `Alchemical`, `Quantum`, `Other Physical` `Empirical`, `Mixed`, or `Other`.
# Pick only one category label.
# The `Category:` keyword is required.
Category:
Alchemical
#
# All submissions must either be ranked or non-ranked.
# Only one ranked submission per participant is allowed.
# Multiple ranked submissions from the same participant will not be judged.
# Non-ranked submissions are accepted so we can verify that they were made before the deadline.
# The "Ranked:" keyword is required, and expects a Boolean value (True/False)
Ranked:
False
